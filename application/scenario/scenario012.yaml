name: scenario012
desc: Замена цен в аэрозолях-трехслойках, добавление 650 мл

settings:
  output_service: Storeland
  output_format: csv
  # Категорию пока вынес сюда, т.к. она нужна для директории
  category: Paint
  #test: true

process:

  # Преобразуем данные из файла Стореленда в коллекцию Product
  - name: ParseToProduct
    settings:
      from: Storeland
      format: csv
      category: Paint
      modification: true
      skip_product_by_id: [52723164]

  # Проверяем картинки - везде должно быть одинаковое кол-во
  - name: CheckImageQty
    #skip: true

  # Готовим картинку для заливки
  - name: MergeImage
    #skip: true
    settings:
      output:
        width: 800
        height: 800
        format: jpg
      img1:
        name: 650.png
        reduce: 1
        offsetX: -100
        offsetY: 5
        rotate: 0
      img2:
        number: 2 # номер цвета по счету начиная с 0, обычно последнее фото
        reduce: 0.5
        offsetX: 550
        offsetY: 350
        rotate: 90

  # Замена цен в модификациях
  - name: ReplaceModificationPrice
    #skip: true
    settings:
      '729,10': 860
      '982,10': 1127
      '1 067,20': 1393
      '1 320,20': 1660
      '1 235,10': 1394
      '1 573,20': 1927
      '1 313,30': 1360
      '1 566,30': 1627
      '1 651,40': 1893
      '1 904,40': 2160
      '1 819,30': 1894
      '2 157,40': 2427

  # копируем картинку номер 2 в конец массива
  - name: CopyImage
    #skip: true
    settings:
      number: 2

  # теперь заменяем вторую картинку новым изображением, получается мы вставили новую картинку
  - name: ReplaceImage
    #skip: true
    settings:
      2: img/3-aerozol/650.png/{brand_car}/{id}.jpg

  - name: AddModification
    #skip: true
    settings:
      modifications:
        -
          'Описание модификации товара': 'Баллон 2x650 мл'
          'Изображение модификации товара': ''
          'Цена продажи, без учёта скидок': 1760
          'Название св-ва для модификации товара №1': 'Объем'
          'Значение св-ва для модификации товара №1': '650 мл.'
          'Название св-ва для модификации товара №2': 'Грунт для металла'
          'Значение св-ва для модификации товара №2': 'Без грунта'
          'Название св-ва для модификации товара №3': 'Грунт для пластика'
          'Значение св-ва для модификации товара №3': 'Без грунта для пластика'
          'Название св-ва для модификации товара №4': 'Лак'
          'Значение св-ва для модификации товара №4': 'Без лака'

        -
          'Описание модификации товара': 'Баллон 2x650 мл + лак'
          'Изображение модификации товара': ''
          'Цена продажи, без учёта скидок': 2027
          'Название св-ва для модификации товара №1': 'Объем'
          'Значение св-ва для модификации товара №1': '650 мл.'
          'Название св-ва для модификации товара №2': 'Грунт для металла'
          'Значение св-ва для модификации товара №2': 'Без грунта'
          'Название св-ва для модификации товара №3': 'Грунт для пластика'
          'Значение св-ва для модификации товара №3': 'Без грунта для пластика'
          'Название св-ва для модификации товара №4': 'Лак'
          'Значение св-ва для модификации товара №4': 'С лаком'

        -
          'Описание модификации товара': 'Баллон 2x650 мл + грунт для пластика'
          'Изображение модификации товара': ''
          'Цена продажи, без учёта скидок': 2293
          'Название св-ва для модификации товара №1': 'Объем'
          'Значение св-ва для модификации товара №1': '650 мл.'
          'Название св-ва для модификации товара №2': 'Грунт для металла'
          'Значение св-ва для модификации товара №2': 'Без грунта'
          'Название св-ва для модификации товара №3': 'Грунт для пластика'
          'Значение св-ва для модификации товара №3': 'С грунтом для пластика'
          'Название св-ва для модификации товара №4': 'Лак'
          'Значение св-ва для модификации товара №4': 'Без лака'

        -
          'Описание модификации товара': 'Баллон 2x650 мл + лак + грунт для пластика'
          'Изображение модификации товара': ''
          'Цена продажи, без учёта скидок': 2560
          'Название св-ва для модификации товара №1': 'Объем'
          'Значение св-ва для модификации товара №1': '650 мл.'
          'Название св-ва для модификации товара №2': 'Грунт для металла'
          'Значение св-ва для модификации товара №2': 'Без грунта'
          'Название св-ва для модификации товара №3': 'Грунт для пластика'
          'Значение св-ва для модификации товара №3': 'С грунтом для пластика'
          'Название св-ва для модификации товара №4': 'Лак'
          'Значение св-ва для модификации товара №4': 'С лаком'

        -
          'Описание модификации товара': 'Баллон 2x650 мл + грунт для металла'
          'Изображение модификации товара': ''
          'Цена продажи, без учёта скидок': 2027
          'Название св-ва для модификации товара №1': 'Объем'
          'Значение св-ва для модификации товара №1': '650 мл.'
          'Название св-ва для модификации товара №2': 'Грунт для металла'
          'Значение св-ва для модификации товара №2': 'С грунтом'
          'Название св-ва для модификации товара №3': 'Грунт для пластика'
          'Значение св-ва для модификации товара №3': 'Без грунта для пластика'
          'Название св-ва для модификации товара №4': 'Лак'
          'Значение св-ва для модификации товара №4': 'Без лака'

        -
          'Описание модификации товара': 'Баллон 2x650 мл + грунт для металла + лак'
          'Изображение модификации товара': ''
          'Цена продажи, без учёта скидок': 2294
          'Название св-ва для модификации товара №1': 'Объем'
          'Значение св-ва для модификации товара №1': '650 мл.'
          'Название св-ва для модификации товара №2': 'Грунт для металла'
          'Значение св-ва для модификации товара №2': 'С грунтом'
          'Название св-ва для модификации товара №3': 'Грунт для пластика'
          'Значение св-ва для модификации товара №3': 'Без грунта для пластика'
          'Название св-ва для модификации товара №4': 'Лак'
          'Значение св-ва для модификации товара №4': 'С лаком'

        -
          'Описание модификации товара': 'Баллон 2x650 мл + грунт для металла + грунт для пластика'
          'Изображение модификации товара': ''
          'Цена продажи, без учёта скидок': 2560
          'Название св-ва для модификации товара №1': 'Объем'
          'Значение св-ва для модификации товара №1': '650 мл.'
          'Название св-ва для модификации товара №2': 'Грунт для металла'
          'Значение св-ва для модификации товара №2': 'С грунтом'
          'Название св-ва для модификации товара №3': 'Грунт для пластика'
          'Значение св-ва для модификации товара №3': 'С грунтом для пластика'
          'Название св-ва для модификации товара №4': 'Лак'
          'Значение св-ва для модификации товара №4': 'Без лака'

        -
          'Описание модификации товара': 'Баллон 2x650 мл + лак + грунт для металла + грунт для пластика'
          'Изображение модификации товара': ''
          'Цена продажи, без учёта скидок': 2827
          'Название св-ва для модификации товара №1': 'Объем'
          'Значение св-ва для модификации товара №1': '650 мл.'
          'Название св-ва для модификации товара №2': 'Грунт для металла'
          'Значение св-ва для модификации товара №2': 'С грунтом'
          'Название св-ва для модификации товара №3': 'Грунт для пластика'
          'Значение св-ва для модификации товара №3': 'С грунтом для пластика'
          'Название св-ва для модификации товара №4': 'Лак'
          'Значение св-ва для модификации товара №4': 'С лаком'

  # Сохраняем в файл
  - name: ProductToFile
    #skip: true
    settings:
      # для разделов указать Paint, для RAL и трехслоек - Product
      from: Product
      to: Storeland
      format: csv
      modification: true
      #clear_fields: ['Изображение модификации товара']
      by_brand_car: true
