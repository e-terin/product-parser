name: scenario010
desc: Замена цен в аэрозолях

settings:
  output_service: Storeland
  output_format: csv
  # Категорию пока вынес сюда, т.к. она нужна для директории
  category: Paint
  #test: true

process:

  # Преобразуем данные из файла Стореленда в коллекцию Product
  - name: ParseToProduct
    settings:
      from: Storeland
      format: csv
      category: Paint
      modification: true

  # Проверяем картинки - везде должно быть одинаковое кол-во
  - name: CheckImageQty
    #skip: true

  # Готовим картинку для заливки
  - name: MergeImage
    #skip: true
    settings:
      output:
        width: 800
        height: 800
        format: jpg
      img1:
        name: 650.png
        reduce: 1
        offsetX: -100
        offsetY: 5
        rotate: 0
      img2:
        number: 2 # номер цвета по счету начиная с 0, обычно последнее фото
        reduce: 0.5
        offsetX: 550
        offsetY: 350
        rotate: 90

  # Замена цен в модификациях
  - name: ReplaceModificationPrice
    #skip: true
    settings:
      '364,55': 430
      '617,55': 697
      '702,65': 963
      '955,65': 1230
      '870,55': 964
      '1 208,65': 1497
      '656,65': 680
      '909,65': 947
      '994,75': 1213
      '1 162,65': 1214
      '1 247,75': 1480
      '1 500,75': 1747

  # копируем картинку номер 2 в конец массива
  - name: CopyImage
    settings:
      number: 2

  # теперь заменяем вторую картинку новым изображением, получается мы вставили новую картинку
  - name: ReplaceImage
    #skip: true
    settings:
      2: img/aerozol/650.png/{brand_car}/{id}.jpg

  - name: AddModification
    #skip: true
    settings:
      modifications:
        -
          'Описание модификации товара': 'Баллон 650 мл'
          'Изображение модификации товара': ''
          'Цена продажи, без учёта скидок': 880
          'Название св-ва для модификации товара №1': 'Объем'
          'Значение св-ва для модификации товара №1': '650 мл.'
          'Название св-ва для модификации товара №2': 'Грунт для металла'
          'Значение св-ва для модификации товара №2': 'Без грунта'
          'Название св-ва для модификации товара №3': 'Грунт для пластика'
          'Значение св-ва для модификации товара №3': 'Без грунта для пластика'
          'Название св-ва для модификации товара №4': 'Лак'
          'Значение св-ва для модификации товара №4': 'Без лака'

        -
          'Описание модификации товара': 'Баллон 650 мл + лак'
          'Изображение модификации товара': ''
          'Цена продажи, без учёта скидок': 1147
          'Название св-ва для модификации товара №1': 'Объем'
          'Значение св-ва для модификации товара №1': '650 мл.'
          'Название св-ва для модификации товара №2': 'Грунт для металла'
          'Значение св-ва для модификации товара №2': 'Без грунта'
          'Название св-ва для модификации товара №3': 'Грунт для пластика'
          'Значение св-ва для модификации товара №3': 'Без грунта для пластика'
          'Название св-ва для модификации товара №4': 'Лак'
          'Значение св-ва для модификации товара №4': 'С лаком'

        -
          'Описание модификации товара': 'Баллон 650 мл + грунт для пластика'
          'Изображение модификации товара': ''
          'Цена продажи, без учёта скидок': 1413
          'Название св-ва для модификации товара №1': 'Объем'
          'Значение св-ва для модификации товара №1': '650 мл.'
          'Название св-ва для модификации товара №2': 'Грунт для металла'
          'Значение св-ва для модификации товара №2': 'Без грунта'
          'Название св-ва для модификации товара №3': 'Грунт для пластика'
          'Значение св-ва для модификации товара №3': 'С грунтом для пластика'
          'Название св-ва для модификации товара №4': 'Лак'
          'Значение св-ва для модификации товара №4': 'Без лака'

        -
          'Описание модификации товара': 'Баллон 650 мл + лак + грунт для пластика'
          'Изображение модификации товара': ''
          'Цена продажи, без учёта скидок': 1680
          'Название св-ва для модификации товара №1': 'Объем'
          'Значение св-ва для модификации товара №1': '650 мл.'
          'Название св-ва для модификации товара №2': 'Грунт для металла'
          'Значение св-ва для модификации товара №2': 'Без грунта'
          'Название св-ва для модификации товара №3': 'Грунт для пластика'
          'Значение св-ва для модификации товара №3': 'С грунтом для пластика'
          'Название св-ва для модификации товара №4': 'Лак'
          'Значение св-ва для модификации товара №4': 'С лаком'

        -
          'Описание модификации товара': 'Баллон 650 мл + грунт для металла'
          'Изображение модификации товара': ''
          'Цена продажи, без учёта скидок': 1147
          'Название св-ва для модификации товара №1': 'Объем'
          'Значение св-ва для модификации товара №1': '650 мл.'
          'Название св-ва для модификации товара №2': 'Грунт для металла'
          'Значение св-ва для модификации товара №2': 'С грунтом'
          'Название св-ва для модификации товара №3': 'Грунт для пластика'
          'Значение св-ва для модификации товара №3': 'Без грунта для пластика'
          'Название св-ва для модификации товара №4': 'Лак'
          'Значение св-ва для модификации товара №4': 'Без лака'

        -
          'Описание модификации товара': 'Баллон 650 мл + грунт для металла + лак'
          'Изображение модификации товара': ''
          'Цена продажи, без учёта скидок': 1414
          'Название св-ва для модификации товара №1': 'Объем'
          'Значение св-ва для модификации товара №1': '650 мл.'
          'Название св-ва для модификации товара №2': 'Грунт для металла'
          'Значение св-ва для модификации товара №2': 'С грунтом'
          'Название св-ва для модификации товара №3': 'Грунт для пластика'
          'Значение св-ва для модификации товара №3': 'Без грунта для пластика'
          'Название св-ва для модификации товара №4': 'Лак'
          'Значение св-ва для модификации товара №4': 'С лаком'

        -
          'Описание модификации товара': 'Баллон 650 мл + грунт для металла + грунт для пластика'
          'Изображение модификации товара': ''
          'Цена продажи, без учёта скидок': 1680
          'Название св-ва для модификации товара №1': 'Объем'
          'Значение св-ва для модификации товара №1': '650 мл.'
          'Название св-ва для модификации товара №2': 'Грунт для металла'
          'Значение св-ва для модификации товара №2': 'С грунтом'
          'Название св-ва для модификации товара №3': 'Грунт для пластика'
          'Значение св-ва для модификации товара №3': 'С грунтом для пластика'
          'Название св-ва для модификации товара №4': 'Лак'
          'Значение св-ва для модификации товара №4': 'Без лака'

        -
          'Описание модификации товара': 'Баллон 650 мл + лак + грунт для металла + грунт для пластика'
          'Изображение модификации товара': ''
          'Цена продажи, без учёта скидок': 1947
          'Название св-ва для модификации товара №1': 'Объем'
          'Значение св-ва для модификации товара №1': '650 мл.'
          'Название св-ва для модификации товара №2': 'Грунт для металла'
          'Значение св-ва для модификации товара №2': 'С грунтом'
          'Название св-ва для модификации товара №3': 'Грунт для пластика'
          'Значение св-ва для модификации товара №3': 'С грунтом для пластика'
          'Название св-ва для модификации товара №4': 'Лак'
          'Значение св-ва для модификации товара №4': 'С лаком'

  # Сохраняем в файл
  - name: ProductToFile
    #skip: true
    settings:
      # для разделов указать Paint, для RAL и трехслоек - Product
      from: Paint
      to: Storeland
      format: csv
      modification: true
      #clear_fields: ['Изображение модификации товара']
      by_brand_car: true
